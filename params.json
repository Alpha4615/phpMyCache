{"name":"phpMyCache","tagline":"Easy caching of mySQL queries","body":"# Give your database a breather!\r\n\r\nphpMyCache is a simple library written in PHP that allows developers to not put unnecessary strain on databases for queries that do not require \"as of this exact moment\" accuracy. Why should you constantly ask the mySQL database for \"yesterday's most downloaded files?\" Just cache that result set for 24 hours. Why force your database to re-fetch your latest blog entries when you only write once a week? Cache that result set for a couple days!\r\n\r\nIt's that simple. Allow phpMyCache to handle your caching. Pass it the SELECT query you'd normally pass directly to mySQL. phpMyCache will automatically detect the current cache status for that query and either load the the cached data or re-fetch it from the database. \r\n\r\n## How Does It Work?\r\n\r\nIt's really simple. You include the library in your code and instantiate the phpMyCache class into an object. When you pass a query into the library with via the **queryCache()**, the library generates a signature of your query by creating a SHA1 hash of it. Along with the query string, you may also pass a expiry length in seconds of how long this cached data result should be considered fresh. \r\n\r\nThe retrieved data plus the metadata (expiry duration and timestamp of cache creation) is stored as a serialized array. This is so that the library can later load this back into an array to determine the staleness of the cache and decide whether or not it should re-fetch the data.\r\n\r\n## Other Use Cases\r\n\r\n*   Count of registered users\r\n*   List of recent popular threads or content items\r\n*   Daily statistics\r\n\r\n## Configuration\r\nphpMyCache requires a few configuration settings that can be passed when the phpMyCache class is instantiated or through a getter/setter after the class is instantiated. This list may change frequently, so it's best to monitor the README.md file! But here's two examples on how to do load settings into a phpMyCache instance:\r\n\r\n### Array Pre-Instantiation \r\n```\r\n$phpMyCacheConfig = array(\r\n    'cacheDirectory'                => '/home/johndoe/web/cache/',\r\n    'defaultExpiry'                 => 3600\r\n);\r\n$pmc = new phpMyCache($database, $phpMyCacheConfig);\r\n```\r\n\r\n### Getter/Setter Post-Instantiation\r\n```\r\n$pmc = new phpMyCache($database);\r\n$pmc->setOption('cacheDirectory', '/home/johndoe/web/cache/')\r\n    ->setOption('defaultExpiry', 3600);\r\n```\r\n\r\n## Implementation Example\r\nThe following code would pull the latest 10 articles from a table called news. The first request of this data will query the database directly. The results are restored for subsequent requests to this exact query that happen within the next hour (3600 seconds). After that time, the cache is invalidated and the database will be queried directly again.\r\n\r\n```\r\n<?php\r\ninclude('../phpMyCache/lib/phpMyCache.php');\r\ninclude('../phpMyCache/phpMyCache.conf.php');\r\n\r\n\r\n$database = mysqli_connect('localhost', 'root', 'password', 'database');\r\n$cacheDB = new phpMyCache($database, $phpMyCacheConfig);\r\n$result = $cacheDB->queryCache(\"SELECT headline FROM news ORDER BY pubDate DESC LIMIT 0,10\", 3600);\r\n\r\nforeach ($result as $key => $newsItem) {\r\n    print $newsItem['headline'].\"<br />\";\r\n}\r\n\r\n\r\n?>\r\n```\r\n\r\n## Tools\r\n### cleanExpiredCache.php\r\nCurrently cache files are never deleted. This can result in a lot of files sitting around in your cache directory. This tool, when executed, will scan all files in your cache directory and delete the ones that have expired. This is useful as a nightly cron. To use it, you must create your own file (let's say, cleanup.php) and define $cacheDirectory prior to including the tool file. Your file should look something similar to this:\r\n\r\n```\r\n<?php\r\n $cacheDirectory = '/home/johndoe/web/cache';\r\n require('/home/johndoe/web/phpMyCache/tools/cleanExpiredCache.php');\r\n?>\r\n```\r\nNow simply add cleanup.php to your crontab and you're good to go!\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}